<!DOCTYPE html>
<html lang="en">
<head>
	<title>three.js example</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<style>
		body {
			background-color: #ffffff;
			margin: 0px;
			overflow: hidden;
		}
	</style>
</head>
<body>
	<div id="WebGL-output"> </div>
	<script type="text/javascript" src="http://threejs.org/build/three.js"></script>
	<script type="text/javascript">
		function init() {
			// The SCENE
			var scene = new THREE.Scene();

            // The GROUND plane
			var planeGeometry = new THREE.PlaneGeometry(60, 20);
			var planeMaterial = new THREE.MeshPhongMaterial({ color: 0xcccccc });
			var plane = new THREE.Mesh(planeGeometry, planeMaterial);

			// Rotate and position the plane
			plane.rotation.x = -0.5 * Math.PI; // TODO: What happens if you comment out this line of code?
			plane.position.x = 15;
			plane.position.y = 0;
			plane.position.z = 0;

			plane.receiveShadow = true;
			scene.add(plane);

			// Add coordinate AXIS to the scene
			var axes = new THREE.AxesHelper(20);
			scene.add(axes);

			// A CUBE
			var cubeGeometry = new THREE.BoxBufferGeometry(3, 3, 3);
			var cubeMaterial = new THREE.MeshPhongMaterial({ color: 0xff0000, wireframe: false });
			var cube = new THREE.Mesh(cubeGeometry, cubeMaterial);

			cube.position.x = -4;
			cube.position.y = 1.5;
			cube.position.z = -3;

			cube.castShadow = true;
			cube.receiveShadow = true;

			scene.add(cube);

			// A SPHERE
			var sphereGeometry = new THREE.SphereGeometry(3, 12, 12);
			var sphereMaterial = new THREE.MeshPhongMaterial({ color: 0x7777ff, wireframe: false });
			var sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);

			// Position the sphere and add it to the scene
			// TODO: What happens if you comment out the next three lines of code?
			sphere.position.x = 20;
			sphere.position.y = 3;
			sphere.position.z = 2;

			sphere.castShadow = true;
			sphere.receiveShadow = true;

			scene.add(sphere);

			//A Cyllinder
			var cylinderGeometry = new THREE.CylinderGeometry(3, 3, 7, 32);
			var cylinderMaterial = new THREE.MeshPhongMaterial({ color: 0x00ff00, wireframe: false });
			var cylinder = new THREE.Mesh(cylinderGeometry, cylinderMaterial);

			cylinder.position.x = 2;
			cylinder.position.y = 4;
			cylinder.position.z = -4;

			cylinder.castShadow = true;
			cylinder.receiveShadow = true;	

			scene.add(cylinder);

			// A TORUS
			var torusGeometry = new THREE.TorusGeometry(3, 1.2, 12, 77);
			var torusMaterial = new THREE.MeshPhongMaterial({ color: 0x00dddd, wireframe: false });
			var torus = new THREE.Mesh(torusGeometry, torusMaterial);

			torus.position.x = 12;
			torus.position.y = 4;
			torus.position.z = -4;

			torus.castShadow = true;
			torus.receiveShadow = true;

			scene.add(torus);

			// A CONE
			var coneGeometry = new THREE.ConeGeometry(3, 10, 32);
			var coneMaterial = new THREE.MeshPhongMaterial({ color: 0xcc00c0, wireframe: false });
			var cone = new THREE.Mesh(coneGeometry, coneMaterial);

			cone.position.x = 25;
			cone.position.y = 6;
			cone.position.z = -4;

			cone.castShadow = true;
			cone.receiveShadow = true;

			scene.add(cone);

			// CYLINDER WITH DIFFERENT BASES
			var cylinderGeometry2 = new THREE.CylinderGeometry(0.8, 2.1, 9, 32);
			var cylinderMaterial2 = new THREE.MeshPhongMaterial({ color: 0xf2c846, wireframe: false });
			var cylinder2 = new THREE.Mesh(cylinderGeometry2, cylinderMaterial2);

			cylinder2.position.x = 40;
			cylinder2.position.y = 5;
			cylinder2.position.z = 4;

			cylinder2.castShadow = true;
			cylinder2.receiveShadow = true;

			scene.add(cylinder2);

            // The CAMERA
			// --- Where the viewer is and how he is looking at the scene
			var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000);

			// Position the camera
			camera.position.x = -30;
			camera.position.y = 40;
			camera.position.z = 30;

			// LIGHT
			const light = new THREE.PointLight( 0xffffff );
            light.position.set( -40, 60, -10 );
			light.castShadow = true;
			light.shadowMapWidth = 2048;
			light.shadowMapHeight= 2048;
            scene.add( light );

			// Point the camera to the center of the scene
			camera.lookAt(scene.position);
			scene.add(camera)

			// The RENDERER --- To display the scene on the Web page
			var renderer = new THREE.WebGLRenderer({ antialias: true });
			renderer.setClearColor(new THREE.Color(0x222222));
			renderer.setPixelRatio(window.devicePixelRatio);
			renderer.setSize(window.innerWidth, window.innerHeight);
			renderer.shadowMap.enabled = true; //para renderizar as sombras
			renderer.shadowMapType = THREE.PCFSoftShadowMap; //para renderizar as sombras

			// Add the output of the renderer to the html element
			document.getElementById("WebGL-output").appendChild(renderer.domElement);

			// Render the scene
            renderer.render(scene, camera);
            
            var step = 0; 
            // Update model features and render the scene 
            renderScene()
 
            function renderScene() { 
                // Rotate the cube around its axes 
                cube.rotation.x += 0.02; 
                cube.rotation.y += 0.02; 
                cube.rotation.z += 0.02; 
            
                step += 0.04; 
                // Bounce the sphere up and down 
                sphere.position.x = 20 + (10 * Math.cos(step)); 
                sphere.position.y = 3 + (10 * Math.abs(Math.sin(step)));

                torus.rotation.x += 0.05;

                cylinder.position.z = 2 + (3 * Math.cos(step));

                // Render using requestAnimationFrame 
                requestAnimationFrame(renderScene); 
                renderer.render(scene, camera);
            }
        

            function onResize() { 
                camera.aspect = window.innerWidth / window.innerHeight; 
                camera.updateProjectionMatrix(); 
                renderer.setSize(window.innerWidth, window.innerHeight); 
            }
            window.addEventListener('resize', onResize, false); 
        }
        window.onload = init;
        
	</script>
</body>
</html>